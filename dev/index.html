<!DOCTYPE html>
<html lang="de" id="htmlRoot">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ufzgiblatt.ch</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="js/analytics.js"></script>
</head>

<header class="site-header no-print">
    <div class="header-content">
        <div class="site-logo">
            <a href="/">
                <span class="logo-text">ufzgiblatt<span class="logo-suffix">.ch</span></span>
            </a>
        </div>
        <nav class="main-nav">
            <a href="#generator" class="nav-link active" id="navGenerator">ArbeitsblÃ¤tter</a>
            <a href="#builder" class="nav-link" id="navBuilder">Baukasten</a>
            <div class="nav-dropdown">
                <span class="nav-link dropdown-trigger" id="navGames">Spiele</span>
                <div class="dropdown-content">
                    <a href="geography-game" id="navGameGeo">Geographie</a>
                </div>
            </div>
        </nav>
        <div class="lang-group">
            <a href="?lang=de" class="lang-btn" id="lang-de-header">DE</a>
            <a href="?lang=en" class="lang-btn" id="lang-en-header">EN</a>
        </div>
    </div>
</header>

<main>
    <section id="generator" class="active-section">
        <div class="controls">
            <select id="gradeSelector" onchange="updateTopicSelector(); generateSheet(true);">
                <option value="1">1. Klasse</option>
                <option value="2">2. Klasse</option>
                <option value="3">3. Klasse</option>
                <option value="4">4. Klasse</option>
                <option value="5">5. Klasse</option>
                <option value="6">6. Klasse</option>
            </select>
            <select id="topicSelector" onchange="generateSheet(true)">
                <!-- Options populated by JS -->
            </select>
            <div style="display:flex; align-items:center;">
                <label for="pageCount" id="labelCount"
                    style="font-weight:bold; margin-right:5px; font-family:'Nunito',sans-serif;">Anzahl:</label>
                <input type="number" id="pageCount" value="1" min="1" max="50" oninput="generateSheet(true)"
                    style="width:50px; padding:12px; border-radius:12px; border:2px solid #ddd; font-family:'Nunito',sans-serif; font-size:1rem; outline:none; text-align:center;">
            </div>
            <div style="display:flex; align-items:center;">
                <input type="checkbox" id="solutionToggle" style="width:20px; height:20px; margin-right:5px;"
                    onchange="renderCurrentState(); updateURLState();">
                <label for="solutionToggle" id="labelSolutions">LÃ¶sungsblatt</label>
            </div>
            <button class="btn-generate" id="btnGenerate" onclick="generateSheet()">âœ¨ Neu erstellen</button>
            <button class="btn-save" id="btnSave" onclick="saveCurrentState()">ğŸ’¾ Speichern</button>
            <button class="btn-saved" id="btnSaved" onclick="toggleSavedModal()">ğŸ“‚ Gespeichert</button>
            <!-- Check button removed in favor of real-time validation -->
            <button class="btn-print" id="btnPrint" onclick="printSheet()">ğŸ–¨ï¸ Drucken</button>
            <div style="display:flex; align-items:center; gap: 15px;">
                <div style="display:flex; align-items:center;">
                    <input type="checkbox" id="hideLogo" style="width:20px; height:20px; margin-right:5px;"
                        onchange="toggleLogoVisibility()">
                    <label for="hideLogo" id="labelHideLogo">Logo ausblenden</label>
                </div>
                <div style="display:flex; align-items:center;">
                    <input type="checkbox" id="hideQR" style="width:20px; height:20px; margin-right:5px;"
                        onchange="toggleQRVisibility()">
                    <label for="hideQR" id="labelHideQR">QR-Code ausblenden</label>
                </div>
            </div>
        </div>

        <div class="controls" id="customOptions"
            style="display:none; flex-direction:column; align-items:flex-start; margin-top:-1rem; font-family:'Nunito',sans-serif;">
            <div id="customTitle" style="margin-bottom:10px; font-weight:bold;">WÃ¤hle die Aufgabentypen:</div>
            <div id="checkboxContainer" style="display:flex; flex-wrap:wrap; gap:15px;">
                <!-- Checkboxes populated by JS -->
            </div>
        </div>
        </div>
        </div>

        <div class="controls" id="marriedOptions"
            style="display:none; align-items:center; margin-top:-1rem; font-family:'Nunito',sans-serif; gap:10px;">
            <input type="checkbox" id="marriedMultiplesOf10" style="width:20px; height:20px;"
                onchange="generateSheet(true)">
            <label for="marriedMultiplesOf10" id="labelMultiplesOf10">Nur Zehnerzahlen (z.B. 30 + 70)</label>
        </div>

        <div class="controls" id="moneyOptions"
            style="display:none; align-items:center; margin-top:-1rem; font-family:'Nunito',sans-serif; gap:10px;">
            <span style="font-weight:bold;" id="labelCurrency">WÃ¤hrung:</span>

            <input type="checkbox" id="currencyCHF" value="CHF" checked onchange="generateSheet(true)">
            <label for="currencyCHF">CHF</label>

            <input type="checkbox" id="currencyEUR" value="EUR" onchange="generateSheet(true)">
            <label for="currencyEUR">EUR</label>
        </div>

        <div class="controls" id="timeOptions"
            style="display:none; align-items:center; margin-top:-1rem; font-family:'Nunito',sans-serif; gap:10px;">
            <input type="checkbox" id="showHours" style="width:20px; height:20px;" onchange="generateSheet(true)">
            <label for="showHours" id="labelHours" style="color:green; font-weight:bold;">Stunden</label>

            <input type="checkbox" id="showMinutes" style="width:20px; height:20px;" onchange="generateSheet(true)">
            <label for="showMinutes" id="labelMinutes" style="color:blueviolet; font-weight:bold;">Minuten</label>
        </div>


        <div id="sheetsWrapper">
            <!-- Sheets will be inserted here -->
        </div>
    </section>

    <section id="builder">
        <div class="controls no-print">
            <h2 id="builderTitle" style="font-family:'Nunito',sans-serif; margin-bottom: 20px;">Individueller Baukasten
            </h2>
            <div class="builder-top-controls"
                style="display:flex; flex-wrap:wrap; gap:15px; align-items:center; width:100%;">
                <div class="control-group">
                    <label for="builderTitleInput">Titel:</label>
                    <input type="text" id="builderTitleInput" placeholder="Eigener Titel"
                        style="padding: 8px; border-radius: 8px; border: 1px solid #ccc; font-family:'Nunito',sans-serif;">
                </div>
                <div class="control-group">
                    <label for="builderGradeSelector" id="labelBuilderGrade">Klasse:</label>
                    <select id="builderGradeSelector" onchange="window.updateBuilderTopics()"></select>
                </div>
                <div class="control-group">
                    <label for="builderTopicSelector" id="labelBuilderTopic">Aufgabe:</label>
                    <select id="builderTopicSelector" onchange="window.updateBuilderTopicOptions()"></select>
                </div>
                <div id="builderTopicOptions" class="builder-topic-options"
                    style="display:flex; gap:15px; align-items:center;">
                    <!-- Dynamic options will be inserted here -->
                </div>

                <div style="display:flex; gap:10px; margin-left:auto;">
                    <button class="btn-generate" id="btnAddElement" onclick="window.addProblemToBuilder()"
                        style="background: var(--secondary-color);">â• Aufgabe hinzufÃ¼gen</button>
                    <button class="btn-print" id="btnPrintBuilder" onclick="window.printSheet()">ğŸ–¨ï¸ Drucken</button>
                </div>
            </div>
            <div class="builder-actions-secondary" style="display:flex; gap:10px; margin-top:15px;">
                <button class="btn-generate" id="btnRefreshBuilder" onclick="window.refreshBuilderSeed()"
                    style="background: #3498db; padding: 8px 16px; font-size: 0.9rem;">ğŸ”„ Neu wÃ¼rfeln</button>
                <button class="btn-save" id="btnCopyBuilderLink" onclick="window.copyBuilderLink()"
                    style="background: #27ae60; padding: 8px 16px; font-size: 0.9rem;">ğŸ”— Link kopieren</button>
                <button class="btn-saved" id="btnClearBuilderSheet" onclick="window.clearBuilder()"
                    style="background: #e74c3c; padding: 8px 16px; font-size: 0.9rem;">ğŸ—‘ï¸ Leeren</button>
            </div>
        </div>
        <div id="builderSheetContainer" class="builder-sheet-container">
            <div id="builderSheetsWrapper">
                <!-- Live worksheet rendering -->
            </div>
        </div>
    </section>

    <section id="games" class="content-section">
        <div class="section-container">
            <h2 class="section-title" id="titleGames">Lernspiele</h2>
            <div class="games-grid">
                <div class="game-card">
                    <div class="game-icon">ğŸ‡¨ğŸ‡­</div>
                    <h3 id="gameCantonTitle">Kanton Master</h3>
                    <p id="gameCantonDesc">Lerne die Schweizer Kantone auf der interaktiven Karte kennen.</p>
                    <a href="geography-game" class="btn-primary" id="btnPlay"
                        style="display: inline-block; text-decoration: none;">Spielen</a>
                </div>
            </div>
        </div>
    </section>


</main>



<div id="savedModal" class="modal no-print">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Gespeicherte ArbeitsblÃ¤tter</h2>
            <span class="close-modal" onclick="toggleSavedModal()">&times;</span>
        </div>
        <div id="savedList" class="saved-list">
            <!-- Saved items will be listed here -->
        </div>
        <div style="text-align: right; margin-top: 15px;">
            <button class="btn-secondary" id="btnModalClose" onclick="toggleSavedModal()">Schliessen</button>
        </div>
    </div>
</div>

<script type="module" src="script.js"></script>


<footer style="display:flex; flex-direction:column; align-items:center; gap:5px; margin-top:40px; padding-bottom:20px;">
    <a href="https://github.com/Thalwil-fur-Familien/ufzgiblatt/issues/new" target="_blank" class="feedback-button">
        <svg height="16" viewBox="0 0 16 16" version="1.1" width="16" aria-hidden="true" class="github-icon">
            <path fill="currentColor"
                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
            </path>
        </svg>
        <span id="labelFeedback">Feedback & Fehler melden</span>
    </a>
    <div id="build-info" style="margin-top:10px; font-size:0.8rem; color:#888;">Build: 6758e31 (2026-01-12 22:17 CET) - DEV</div>
</footer>
</body>

</html>